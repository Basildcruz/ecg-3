<html>
    <head>
        <link rel="stylesheet" href="index.css" />
        <script type="text/javascript" src="../lib/require.js"></script>
        <script type="text/javascript">
            requirejs.config({
                baseUrl : './'
            });

            require(['Electrocardiogram'], function(Electrocardiogram) {
                var ecg = new Electrocardiogram(document.body);
                var ncell = Math.round(ecg.getWidth() / Electrocardiogram.CELL_SIZE);

                require(['Assets'], function(Assets) {
                    var data = (function() {
                        var pqrst = Assets.data['PQRST'].slice();

                        for (var i = 0; i < ncell - 1; i++) {
                            pqrst.unshift(null);
                        }

                        return pqrst;
                    })();

                    var timer = window.setInterval(function() {
                        if (data.length) {
                            ecg.drawCurve(data.slice(0, ncell));
                            data.shift();
                        } else {
                            window.clearInterval(timer);
                        }
                    }, Electrocardiogram.FREQUENCY);
                });
            });
        </script>
    </head>
    <body>
    </body>
</html>
